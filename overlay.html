<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Stealth AI Overlay</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #ffffff;
            overflow: hidden;
            user-select: none;
            -webkit-app-region: drag;
            height: 100vh;
        }
        
        .bar-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-sizing: border-box;
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #2a2a2a 100%);
            border: 1px solid #3a3a3a;
            border-radius: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .left-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #00d4aa;
            box-shadow: 0 0 8px rgba(0, 212, 170, 0.6);
            animation: pulse 2s infinite;
        }
        
        .status-dot.recording {
            background: #ff4444;
            box-shadow: 0 0 8px rgba(255, 68, 68, 0.6);
            animation: pulse 1s infinite;
        }
        
        .center-section {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
            justify-content: center;
        }
        
        .right-section {
            display: flex;
            align-items: center;
            gap: 8px;
            -webkit-app-region: no-drag;
        }
        
        .hotkey-display {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 15px;
            padding: 4px 8px;
            font-size: 10px;
            color: #b0b0b0;
            font-weight: 500;
        }
        
        @keyframes pulse {
            0% { 
                opacity: 1; 
                transform: scale(1);
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.1);
            }
            100% { 
                opacity: 1; 
                transform: scale(1);
            }
        }
        
        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            -webkit-app-region: no-drag;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 12px;
            padding: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            color: #00d4aa;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .modal-input {
            width: 100%;
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 12px;
            color: #fff;
            font-size: 14px;
            margin-bottom: 15px;
            resize: vertical;
            min-height: 80px;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .modal-button {
            background: #444;
            border: 1px solid #666;
            color: #fff;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .modal-button.primary {
            background: #00d4aa;
            border-color: #00d4aa;
            color: #000;
        }
        
        .modal-button:hover {
            opacity: 0.8;
        }
        
        .modal-response {
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            font-size: 13px;
            line-height: 1.4;
        }
        
        /* Notification Styles */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 12px 16px;
            color: #fff;
            font-size: 12px;
            z-index: 10001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            border-color: #ff4444;
            background: rgba(255, 68, 68, 0.1);
        }
        
        .notification.success {
            border-color: #00d4aa;
            background: rgba(0, 212, 170, 0.1);
        }
    </style>
</head>
<body>
    <div class="bar-container">
        <!-- Left section: Just the status dot -->
        <div class="left-section">
            <div class="status-dot" id="statusDot"></div>
        </div>
        
        <!-- Center section: Empty/minimal -->
        <div class="center-section">
        </div>
        
        <!-- Right section: Only hotkeys -->
        <div class="right-section">
            <div class="hotkey-display">⌘⇧H</div>
            <div class="hotkey-display">⌘⇧A</div>
            <div class="hotkey-display">⌘⇧R</div>
            <div class="hotkey-display">⌘⇧S</div>
        </div>
    </div><!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Stealth Overlay</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #ffffff;
            overflow: hidden;
            user-select: none;
            -webkit-app-region: drag;
            height: 100vh;
        }
        
        .bar-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-sizing: border-box;
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #2a2a2a 100%);
            border: 1px solid #3a3a3a;
            border-radius: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .left-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #00d4aa;
            box-shadow: 0 0 8px rgba(0, 212, 170, 0.6);
            animation: pulse 2s infinite;
        }
        
        .status-text {
            font-size: 14px;
            font-weight: 500;
            color: #ffffff;
        }
        
        .center-section {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
            justify-content: center;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: #b0b0b0;
        }
        
        .feature-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #666;
        }
        
        .right-section {
            display: flex;
            align-items: center;
            gap: 12px;
            -webkit-app-region: no-drag;
        }
        
        .hotkey-display {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 11px;
            color: #b0b0b0;
            font-weight: 500;
        }
        
        .control-button {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 18px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #b0b0b0;
            font-size: 12px;
        }
        
        .control-button:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.25);
            color: #ffffff;
        }
        
        .settings-button {
            background: none;
            border: none;
            color: #b0b0b0;
            cursor: pointer;
            font-size: 16px;
            padding: 6px;
            border-radius: 6px;
            transition: all 0.2s ease;
            -webkit-app-region: no-drag;
        }
        
        .settings-button:hover {
            background: rgba(255, 255, 255, 0.08);
            color: #ffffff;
        }
        
        .settings-button:active {
            background: rgba(255, 255, 255, 0.15);
            transform: scale(0.95);
        }
        
        @keyframes pulse {
            0% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 0 0 8px rgba(0, 212, 170, 0.6);
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.1);
                box-shadow: 0 0 12px rgba(0, 212, 170, 0.8);
            }
            100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 0 0 8px rgba(0, 212, 170, 0.6);
            }
        }
        
        .dev-controls {
            position: fixed;
            top: 80px;
            right: 20px;
            background: #2a2a2a;
            border: 2px solid #00d4aa;
            border-radius: 12px;
            padding: 15px;
            display: none;
            gap: 8px;
            flex-direction: column;
            -webkit-app-region: no-drag;
            z-index: 9999;
            min-width: 150px;
            box-shadow: 0 0 20px rgba(0, 212, 170, 0.3);
        }
        
        .dev-controls.show {
            display: flex !important;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .dev-button {
            background: #444;
            border: 1px solid #666;
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .dev-button:hover {
            background: #555;
            border-color: #777;
        }
        
        .dev-button:active {
            background: #333;
            transform: scale(0.98);
        }
        
        .opacity-display {
            font-size: 10px;
            color: #666;
            text-align: center;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div class="bar-container">
        <!-- Left section: Status -->
        <div class="left-section">
            <div class="status-dot"></div>
            <div class="status-text">Stealth Mode</div>
        </div>
        
        <!-- Center section: Features -->
        <div class="center-section">
            <div class="feature-item">
                <div class="feature-dot"></div>
                <span>Screen protected</span>
            </div>
            <div class="feature-item">
                <div class="feature-dot"></div>
                <span>Capture blocked</span>
            </div>
            <div class="feature-item">
                <div class="feature-dot"></div>
                <span>Share invisible</span>
            </div>
        </div>
        
        <!-- Right section: Controls -->
        <div class="right-section">
            <div class="hotkey-display">⌘⇧H</div>
        </div>
    </div>

    <script>
        // Simple immediate execution
        console.log('Script starting...');
        
        // Check if we're in Electron environment
        let ipcRenderer;
        try {
            ipcRenderer = require('electron').ipcRenderer;
            console.log('✅ Electron IPC available');
        } catch (error) {
            console.log('❌ Not in Electron environment:', error);
        }
        
        // Developer controls toggle - simplified
        function toggleDevControls() {
            console.log('👆 toggleDevControls called!');
            const devControls = document.getElementById('devControls');
            if (devControls) {
                const isVisible = devControls.classList.contains('show');
                if (isVisible) {
                    devControls.classList.remove('show');
                    console.log('🙈 Hiding dev controls');
                } else {
                    devControls.classList.add('show');
                    console.log('👁️ Showing dev controls');
                }
            } else {
                console.error('❌ Dev controls element not found!');
            }
        }
        
        // Set up the settings button immediately
        setTimeout(function() {
            console.log('🚀 Setting up button after delay...');
            
            const settingsBtn = document.getElementById('settingsBtn');
            const devControls = document.getElementById('devControls');
            
            console.log('🔍 Settings button found:', !!settingsBtn);
            console.log('🔍 Dev controls found:', !!devControls);
            
            if (settingsBtn && devControls) {
                // Method 1: Try CSS class toggle
                settingsBtn.onclick = function() {
                    console.log('⚙️ Settings clicked!');
                    
                    // Try multiple methods to make it visible
                    if (devControls.classList.contains('show')) {
                        devControls.classList.remove('show');
                        devControls.style.display = 'none';
                        console.log('🙈 Panel hidden');
                    } else {
                        devControls.classList.add('show');
                        devControls.style.display = 'flex';
                        devControls.style.visibility = 'visible';
                        devControls.style.opacity = '1';
                        console.log('👁️ Panel shown - check top-right corner');
                    }
                };
                
                console.log('✅ Settings button setup complete');
                
                // Add a test - show panel briefly on load
                setTimeout(() => {
                    devControls.classList.add('show');
                    devControls.style.display = 'flex';
                    console.log('🧪 Test: Showing panel for 2 seconds...');
                    
                    setTimeout(() => {
                        devControls.classList.remove('show');
                        devControls.style.display = 'none';
                        console.log('🧪 Test: Panel hidden again');
                    }, 2000);
                }, 1000);
                
            } else {
                console.error('❌ Elements not found!');
            }
        }, 100);
        
        // Window control functions using IPC
        async function minimizeWindow() {
            if (!ipcRenderer) {
                console.log('IPC not available - simulating minimize');
                return;
            }
            try {
                await ipcRenderer.invoke('minimize-window');
                console.log('Window minimized');
            } catch (error) {
                console.error('Error minimizing:', error);
            }
        }
        
        async function closeWindow() {
            if (!ipcRenderer) {
                console.log('IPC not available - simulating close');
                return;
            }
            try {
                await ipcRenderer.invoke('close-window');
                console.log('Window closed');
            } catch (error) {
                console.error('Error closing:', error);
            }
        }
        
        let alwaysOnTop = true;
        async function toggleAlwaysOnTop() {
            if (!ipcRenderer) {
                console.log('IPC not available - simulating always on top toggle');
                alwaysOnTop = !alwaysOnTop;
                console.log('Always on top (simulated):', alwaysOnTop);
                return;
            }
            try {
                alwaysOnTop = await ipcRenderer.invoke('toggle-always-on-top');
                console.log('Always on top:', alwaysOnTop);
            } catch (error) {
                console.error('Error toggling always on top:', error);
            }
        }
        
        let currentOpacity = 0.9;
        async function toggleOpacity() {
            const opacityDisplay = document.getElementById('opacityDisplay');
            
            if (currentOpacity === 0.9) {
                currentOpacity = 0.7;
                console.log('⚠️ WARNING: Higher transparency may affect capture protection!');
            } else if (currentOpacity === 0.7) {
                currentOpacity = 0.5;
                console.log('⚠️ DANGER: Very transparent - protection may be broken!');
            } else if (currentOpacity === 0.5) {
                currentOpacity = 0.3;
                console.log('🚨 EXTREME: Almost invisible - protection likely broken!');
            } else if (currentOpacity === 0.3) {
                currentOpacity = 0.1;
                console.log('💀 CRITICAL: Barely visible - protection definitely broken!');
            } else if (currentOpacity === 0.1) {
                currentOpacity = 0.05;
                console.log('👻 GHOST MODE: Almost transparent - this should break everything!');
            } else {
                currentOpacity = 0.9;
                console.log('✅ Back to safe opacity level');
            }
            
            if (ipcRenderer) {
                try {
                    await ipcRenderer.invoke('set-opacity', currentOpacity);
                } catch (error) {
                    console.error('Error setting opacity:', error);
                }
            } else {
                console.log('IPC not available - simulating opacity change to', currentOpacity);
            }
            
            if (opacityDisplay) {
                opacityDisplay.textContent = Math.round(currentOpacity * 100) + '%';
            }
            console.log('Current opacity:', currentOpacity);
        }
        
        async function resetOpacity() {
            currentOpacity = 0.9;
            
            if (ipcRenderer) {
                try {
                    await ipcRenderer.invoke('set-opacity', currentOpacity);
                } catch (error) {
                    console.error('Error resetting opacity:', error);
                }
            } else {
                console.log('IPC not available - simulating opacity reset to', currentOpacity);
            }
            
            const opacityDisplay = document.getElementById('opacityDisplay');
            if (opacityDisplay) {
                opacityDisplay.textContent = '90%';
            }
            console.log('✅ Reset to safe opacity level (0.9)');
        }
        
        async function testCapture() {
            console.log('Test capture function called');
            
            // Flash the window to help with testing
            const originalBg = document.body.style.background;
            const flashColor = currentOpacity < 0.3 ? '#00ff00' : '#ff0000';
            
            document.body.style.background = flashColor;
            console.log(`Flashing window ${flashColor}`);
            
            setTimeout(() => {
                document.body.style.background = originalBg;
                console.log('Flash ended');
            }, 1000);
            
            console.log(`Testing capture protection at opacity ${currentOpacity} - window flashing ${flashColor}`);
            console.log('Try taking a screenshot NOW to test if this window is hidden');
            
            // Get native handle for debugging
            if (ipcRenderer) {
                try {
                    const hwnd = await ipcRenderer.invoke('get-native-handle');
                    console.log('Native window handle (HWND):', hwnd);
                } catch (error) {
                    console.error('Error getting native handle:', error);
                }
            }
        }
        
        // Test the settings button on load
        console.log('🎯 Final setup complete');
        console.log('📝 Instructions: Click the ⚙️ gear icon to toggle developer controls');
        console.log('🔍 Watch this console for click events');
        
        // Log protection status
        console.log('🛡️ Stealth overlay loaded');
        console.log('🔒 Content protection should be active');
        console.log('🧪 Test with: PrtSc, Snipping Tool, Zoom share, OBS');
        console.log('⌨️ Hotkey: Ctrl+Shift+H to hide/show window');
    </script>
    </script>
</body>
</html>